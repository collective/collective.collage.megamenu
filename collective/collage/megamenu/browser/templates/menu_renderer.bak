<ul id="portal-megamenu" class="megamenu"
    tal:define="items view/getItems">

    <li tal:repeat="item items" class="top-level">
        <tal:item define="with_menu python:item.meta_type=='Collage';
                          class python:with_menu and 'menu-dropdown' or ''">
        <a class="menu-item" href="" 
            tal:define="is_link python:item.meta_type=='ATLink';
                        url python:is_link and view.portal_url + item.getRemoteUrl or item.getURL();"
            tal:attributes="href url; 
                            title item/Description;
                            class string:menu-item $class">
            <tal:title content="item/Title">
            Menu item
            </tal:title>
            
            <span class="arrowDownAlternative" tal:condition="with_menu">
                &#9660
            </span>
        </a>

        <div class="sub" 
            tal:condition="with_menu"
            tal:define="object item/getObject" 
            tal:content="structure object/@@renderer" />
        </tal:item>
    </li>
    
</ul>
